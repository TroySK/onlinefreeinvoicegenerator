<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Free Invoice Generator | Create Professional Invoices Instantly</title>
    <meta name="description" content="Create professional invoices for free in seconds with Online Free Invoice Generator. No signup required. Generate, customize, and download PDF invoices instantly.">
    <meta name="keywords" content="online free invoice generator, free invoice, create invoice, invoice template, PDF invoice, business invoice, invoice maker, free invoice generator">
    <meta name="author" content="Online Free Invoice Generator">
    <link rel="canonical" href="https://onlinefreeinvoicegenerator.com">
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://onlinefreeinvoicegenerator.com">
    <meta property="og:title" content="Online Free Invoice Generator | Create Professional Invoices Instantly">
    <meta property="og:description" content="Create professional invoices for free in seconds with Online Free Invoice Generator. No signup required. Generate, customize, and download PDF invoices instantly.">
    <meta property="og:image" content="https://onlinefreeinvoicegenerator.com/invoice-preview.png">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://onlinefreeinvoicegenerator.com">
    <meta property="twitter:title" content="Online Free Invoice Generator | Create Professional Invoices Instantly">
    <meta property="twitter:description" content="Create professional invoices for free in seconds with Online Free Invoice Generator. No signup required. Generate, customize, and download PDF invoices instantly.">
    <meta property="twitter:image" content="https://onlinefreeinvoicegenerator.com/invoice-preview.png">
    
    <!-- Include jsPDF library and plugins -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <!-- Schema.org structured data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "Online Free Invoice Generator",
      "description": "Create professional invoices for free in seconds with Online Free Invoice Generator. No signup required. Generate, customize, and download PDF invoices instantly.",
      "url": "https://onlinefreeinvoicegenerator.com",
      "applicationCategory": "BusinessApplication",
      "operatingSystem": "Any",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      }
    }
    </script>
    
    <style>
        :root {
            --primary-color: #4f46e5;
            --secondary-color: #1f2937;
            --success-color: #10b981;
            --danger-color: #ef4444;
            --warning-color: #f59e0b;
            --light-color: #f9fafb;
            --dark-color: #111827;
            --border-color: #e5e7eb;
            --font-main: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: var(--font-main);
            line-height: 1.6;
            color: #374151;
            background-color: #f3f4f6;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px 0;
        }

        h1 {
            color: var(--secondary-color);
            margin-bottom: 10px;
            font-weight: 700;
            font-size: 2.25rem;
        }

        .app-controls {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 20px;
            margin-top: 20px;
            padding: 20px 0;
            border-top: 1px solid var(--border-color);
        }

        .template-selector {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .template-selector label {
            font-weight: 600;
            color: #4b5563;
            font-size: 1.1rem;
        }

        .template-options {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        @media (max-width: 768px) {
            .template-options {
                justify-content: center;
            }
            
            .template-option svg {
                width: 80px;
                height: 112px;
            }
        }
        
        @media (max-width: 480px) {
            .template-options {
                gap: 10px;
            }
            
            .template-option svg {
                width: 70px;
                height: 98px;
            }
        }

        .template-option {
            text-align: center;
        }

        .template-option input[type="radio"] {
            display: none;
        }

        .template-option label {
            display: block;
            cursor: pointer;
            padding: 10px;
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .template-option input[type="radio"]:checked + label {
            background-color: #eef2ff;
            transform: translateY(-3px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .template-option label:hover {
            background-color: #f9fafb;
        }

        .template-option svg {
            display: block;
            margin: 0 auto 8px;
            border: 1px solid #e5e7eb;
            border-radius: 4px;
        }

        .template-option span {
            display: block;
            font-weight: 500;
            color: #4b5563;
        }

        #download-btn {
            align-self: flex-start;
            height: fit-content;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: #4338ca;
            transform: translateY(-1px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .btn-success {
            background-color: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background-color: #059669;
            transform: translateY(-1px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .invoice-container {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            padding: 40px;
            margin-bottom: 30px;
        }

        .invoice-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
            flex-wrap: wrap;
            gap: 30px;
        }

        .sender-info, .recipient-info {
            flex: 1;
            min-width: 300px;
        }

        @media (max-width: 768px) {
            .invoice-header {
                flex-direction: column;
                gap: 20px;
            }
            
            .sender-info, .recipient-info {
                min-width: 100%;
            }
        }

        .sender-info, .recipient-info {
            flex: 1;
            min-width: 300px;
        }

        .invoice-meta textarea {
            min-height: 80px;
            resize: vertical;
            font-family: var(--font-main);
        }

        .sender-info h3, .recipient-info h3 {
            color: var(--secondary-color);
            margin-bottom: 15px;
            font-size: 1.25rem;
            font-weight: 600;
        }

        .invoice-meta {
            margin-bottom: 30px;
        }

        .invoice-meta-row {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .invoice-meta-group {
            flex: 1;
            min-width: 200px;
        }
        
        @media (max-width: 768px) {
            .invoice-meta-group {
                min-width: 100%;
            }
        }

        .invoice-meta div {
            margin-bottom: 15px;
        }

        .invoice-meta label {
            display: block;
            font-weight: 600;
            margin-bottom: 6px;
            color: #4b5563;
            font-size: 0.875rem;
        }

        .invoice-meta input, .invoice-meta textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-family: var(--font-main);
            font-size: 1rem;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .invoice-meta select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-family: var(--font-main);
            font-size: 1rem;
            transition: border-color 0.2s, box-shadow 0.2s;
            background-color: white;
        }

        .invoice-meta input[type="number"] {
            -moz-appearance: textfield;
        }

        .invoice-meta input[type="number"]::-webkit-outer-spin-button,
        .invoice-meta input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .invoice-meta input:focus, .invoice-meta textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .invoice-meta select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .invoice-meta input.invalid, .invoice-meta textarea.invalid {
            border-color: var(--danger-color);
        }

        .line-items {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }

        .line-items th {
            background-color: #f9fafb;
            text-align: left;
            padding: 14px 16px;
            border-bottom: 2px solid #e5e7eb;
            font-weight: 600;
            color: #4b5563;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }

        .template-modern1 .line-items th {
            background-color: #f9fafb;
            border-bottom-color: #e5e7eb;
            color: #4b5563;
        }

        .template-classic .line-items th {
            background-color: #f3f4f6;
            border-bottom-color: #1f2937;
            color: #1f2937;
        }

        .template-business .line-items th {
            background-color: #eff6ff;
            border-bottom-color: #2563eb;
            color: #2563eb;
        }

        .line-items td {
            padding: 14px 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .line-items tr:last-child td {
            border-bottom: none;
        }

        .line-items tr:hover td {
            background-color: #f9fafb;
        }

        .line-items textarea {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid transparent;
            border-radius: 4px;
            font-family: var(--font-main);
            font-size: 1rem;
            background-color: transparent;
            box-sizing: border-box;
            resize: vertical;
            min-height: 40px;
        }

        .line-items textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            background-color: white;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        /* Responsive table */
        @media screen and (max-width: 768px) {
            .line-items, .line-items thead, .line-items tbody, .line-items th, .line-items td, .line-items tr {
                display: block;
            }

            .line-items thead tr {
                position: absolute;
                top: -9999px;
                left: -9999px;
            }

            .line-items tr {
                border: 1px solid var(--border-color);
                border-radius: 8px;
                margin-bottom: 15px;
                padding: 10px;
                background-color: #f9fafb;
            }

            .line-items td {
                border: none;
                position: relative;
                padding: 8px 8px 8px 40%;
                text-align: right;
                border-bottom: 1px solid var(--border-color);
            }

            .line-items td:before {
                content: attr(data-label);
                position: absolute;
                left: 10px;
                width: 35%;
                text-align: left;
                font-weight: 600;
                color: #4b5563;
            }

            .line-items td:last-child {
                border-bottom: none;
            }

            .line-items .item-amount {
                font-weight: 600;
                color: #1f2937;
            }

            .line-items .tax-cell {
                display: flex;
                flex-direction: column;
                align-items: flex-end;
            }

            .line-items .tax-amount {
                text-align: right;
                margin-top: 5px;
            }
            
            /* Improve input sizing on mobile */
            .line-items input, .line-items textarea {
                font-size: 16px; /* Prevents zoom on iOS */
                max-width: 100%;
            }
            
            .line-items textarea {
                min-height: 60px;
            }
        }

        @media screen and (max-width: 480px) {
            #add-item-btn {
                width: 100%;
                margin-bottom: 20px;
            }
        }

        .line-items input {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid transparent;
            border-radius: 4px;
            font-family: var(--font-main);
            font-size: 1rem;
            background-color: transparent;
            box-sizing: border-box;
            -moz-appearance: textfield;
            text-align: right;
        }

        .line-items input[type="text"] {
            text-align: left;
        }

        .line-items input:focus {
            outline: none;
            border-color: var(--primary-color);
            background-color: white;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .line-items input::-webkit-outer-spin-button,
        .line-items input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .line-items input:focus {
            outline: none;
            border-color: var(--primary-color);
            background-color: white;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .line-items input.invalid {
            color: var(--danger-color);
            border-color: var(--danger-color);
        }

        .tax-amount {
            color: #9ca3af;
            font-size: 0.875rem;
            margin-top: 4px;
            white-space: nowrap;
        }

        td.tax-cell {
            padding: 28px 16px;
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 5px;
            white-space: nowrap;
        }

        .add-item-btn {
            margin-bottom: 30px;
            background-color: #f3f4f6;
            color: #4b5563;
            border: 1px dashed #9ca3af;
        }

        .add-item-btn:hover {
            background-color: #e5e7eb;
            border-color: #6b7280;
            color: #1f2937;
        }

        .totals {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
            max-width: 300px;
            margin-left: auto;
        }
        
        @media (max-width: 768px) {
            .totals {
                max-width: 100%;
                margin-left: 0;
            }
        }

        .totals-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .totals-row input[type="number"] {
            width: 120px;
            padding: 8px 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-family: var(--font-main);
            font-size: 1rem;
            background-color: white;
            box-sizing: border-box;
            -moz-appearance: textfield;
            text-align: right;
        }

        .totals-row input[type="number"]::-webkit-outer-spin-button,
        .totals-row input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .totals-row input[type="number"]:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .total {
            font-weight: 600;
            font-size: 1.1rem;
            padding-top: 10px;
            border-top: 1px solid var(--border-color);
            margin-top: 10px;
        }

        .error {
            color: var(--danger-color);
            font-size: 0.875rem;
            margin-top: 6px;
            font-weight: 500;
        }

        /* Template Styles */
        .template-modern1 {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }

        .template-modern1 .invoice-container {
            border: 1px solid #e5e7eb;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .template-modern1 .btn-primary {
            background-color: #4f46e5;
        }

        .template-modern1 .btn-primary:hover {
            background-color: #4338ca;
        }

        .template-classic {
            font-family: 'Times New Roman', Times, serif;
        }

        .template-classic .invoice-container {
            border: 2px solid #1f2937;
            box-shadow: none;
        }

        .template-classic .btn-primary {
            background-color: #1f2937;
        }

        .template-classic .btn-primary:hover {
            background-color: #111827;
        }

        .template-business {
            font-family: Arial, Helvetica, sans-serif;
        }

        .template-business .invoice-container {
            border: 1px solid #2563eb;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.15);
        }

        .template-business .btn-primary {
            background-color: #2563eb;
        }

        .template-business .btn-primary:hover {
            background-color: #1d4ed8;
        }

        /* Template-specific Add Item button styles */
        .template-modern1 .add-item-btn {
            background-color: #f3f4f6;
            color: #4b5563;
            border: 1px dashed #9ca3af;
        }

        .template-modern1 .add-item-btn:hover {
            background-color: #e5e7eb;
            border-color: #6b7280;
            color: #1f2937;
        }

        .template-classic .add-item-btn {
            background-color: #f3f4f6;
            color: #4b5563;
            border: 1px dashed #9ca3af;
        }

        .template-classic .add-item-btn:hover {
            background-color: #e5e7eb;
            border-color: #6b7280;
            color: #1f2937;
        }

        .template-business .add-item-btn {
            background-color: #eff6ff;
            color: #2563eb;
            border: 1px dashed #93c5fd;
        }

        .template-business .add-item-btn:hover {
            background-color: #dbeafe;
            border-color: #3b82f6;
            color: #1d4ed8;
        }

        .template-modern1 .line-items th {
            background-color: #f9fafb;
            border-bottom-color: #e5e7eb;
            color: #4b5563;
        }

        .template-classic .line-items th {
            background-color: #f3f4f6;
            border-bottom-color: #1f2937;
            color: #1f2937;
        }

        .template-business .line-items th {
            background-color: #eff6ff;
            border-bottom-color: #2563eb;
            color: #2563eb;
        }

        @media print {
            .app-controls {
                display: none;
            }
            
            body {
                padding: 0;
                background-color: white;
            }
            
            .invoice-container {
                box-shadow: none;
                padding: 30px;
            }
        }
        
        @media (max-width: 768px) {
            .app-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .template-selector {
                order: 2;
            }
            
            #download-btn {
                order: 1;
                align-self: stretch;
                margin-bottom: 20px;
            }
        }
    </style>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-0JC8ZK7W10"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-0JC8ZK7W10');
    </script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Online Free Invoice Generator - Create Professional Invoices Instantly</h1>
            <p>Create professional invoices for free in seconds with Online Free Invoice Generator. No signup required. Generate, customize, and download PDF invoices instantly.</p>
        </header>

        <main>

        <div class="invoice-container" id="invoice-container">
            <div class="invoice-header">
                <div class="sender-info">
                    <h3>From</h3>
                    <div class="invoice-meta">
                        <div>
                            <label for="sender-name">Name</label>
                            <input type="text" id="sender-name" placeholder="Your Name">
                            <div class="error" id="sender-name-error"></div>
                        </div>
                        <div>
                            <label for="sender-address">Address</label>
                            <textarea id="sender-address" placeholder="Your Address"></textarea>
                            <div class="error" id="sender-address-error"></div>
                        </div>
                        <div>
                            <label for="sender-email">Email</label>
                            <input type="email" id="sender-email" placeholder="your.email@example.com">
                            <div class="error" id="sender-email-error"></div>
                        </div>
                    </div>
                </div>

                <div class="recipient-info">
                    <h3>To</h3>
                    <div class="invoice-meta">
                        <div>
                            <label for="recipient-name">Name</label>
                            <input type="text" id="recipient-name" placeholder="Client Name">
                            <div class="error" id="recipient-name-error"></div>
                        </div>
                        <div>
                            <label for="recipient-address">Address</label>
                            <textarea id="recipient-address" placeholder="Client Address"></textarea>
                            <div class="error" id="recipient-address-error"></div>
                        </div>
                        <div>
                            <label for="recipient-email">Email</label>
                            <input type="email" id="recipient-email" placeholder="client.email@example.com">
                            <div class="error" id="recipient-email-error"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="invoice-meta">
                <div class="invoice-meta-row">
                    <div class="invoice-meta-group">
                        <div>
                            <label for="invoice-number">Invoice Number</label>
                            <input type="text" id="invoice-number" placeholder="INV-0001">
                            <div class="error" id="invoice-number-error"></div>
                        </div>
                    </div>
                    <div class="invoice-meta-group">
                        <div>
                            <label for="invoice-date">Date</label>
                            <input type="date" id="invoice-date">
                            <div class="error" id="invoice-date-error"></div>
                        </div>
                    </div>
                    <div class="invoice-meta-group currency-selector">
                        <div>
                            <label for="currency-select">Currency</label>
                            <select id="currency-select">
                                <option value="USD">USD - US Dollar</option>
                                <option value="EUR">EUR - Euro</option>
                                <option value="GBP">GBP - British Pound</option>
                                <option value="CAD">CAD - Canadian Dollar</option>
                                <option value="AUD">AUD - Australian Dollar</option>
                                <option value="JPY">JPY - Japanese Yen</option>
                                <option value="CNY">CNY - Chinese Yuan</option>
                                <option value="INR">INR - Indian Rupee</option>
                                <option value="BRL">BRL - Brazilian Real</option>
                                <option value="MXN">MXN - Mexican Peso</option>
                                <option value="SGD">SGD - Singapore Dollar</option>
                                <option value="NZD">NZD - New Zealand Dollar</option>
                                <option value="CHF">CHF - Swiss Franc</option>
                                <option value="HKD">HKD - Hong Kong Dollar</option>
                                <option value="SEK">SEK - Swedish Krona</option>
                                <option value="NOK">NOK - Norwegian Krone</option>
                                <option value="DKK">DKK - Danish Krone</option>
                                <option value="ZAR">ZAR - South African Rand</option>
                                <option value="RUB">RUB - Russian Ruble</option>
                                <option value="KRW">KRW - South Korean Won</option>
                                <option value="TRY">TRY - Turkish Lira</option>
                                <option value="AED">AED - UAE Dirham</option>
                                <option value="SAR">SAR - Saudi Riyal</option>
                                <option value="ILS">ILS - Israeli Shekel</option>
                                <option value="ARS">ARS - Argentine Peso</option>
                                <option value="CLP">CLP - Chilean Peso</option>
                                <option value="COP">COP - Colombian Peso</option>
                                <option value="PEN">PEN - Peruvian Sol</option>
                                <option value="UYU">UYU - Uruguayan Peso</option>
                                <option value="EGP">EGP - Egyptian Pound</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <table class="line-items" id="line-items">
                <thead>
                    <tr>
                        <th>Description</th>
                        <th>Quantity</th>
                        <th>Rate</th>
                        <th>Tax (%)</th>
                        <th>Amount</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td data-label="Description"><textarea class="item-description" placeholder="Item description"></textarea></td>
                        <td data-label="Quantity"><input type="number" class="item-quantity" placeholder="0" min="0" step="1"></td>
                        <td data-label="Rate"><input type="number" class="item-rate" placeholder="0.00" min="0" step="0.01"></td>
                        <td data-label="Tax (%)" class="tax-cell">
                            <input type="number" class="item-tax" placeholder="0" min="0" max="100" step="0.1">
                            <div class="tax-amount" id="tax-amount-0"></div>
                        </td>
                        <td data-label="Amount" class="item-amount">0.00</td>
                    </tr>
                </tbody>
            </table>

            <button id="add-item-btn" class="btn btn-primary add-item-btn">Add Item</button>

            <div class="totals">
                <div class="totals-row">
                    <span>Subtotal:</span>
                    <span id="subtotal">0.00</span>
                </div>
                <div class="totals-row">
                    <span>Total Tax:</span>
                    <span id="total-tax">0.00</span>
                </div>
                <div class="totals-row">
                    <span>Discount:</span>
                    <input type="number" id="discount" placeholder="0.00" min="0" step="0.01" class="discount-input">
                </div>
                <div class="totals-row total">
                    <span>Grand Total:</span>
                    <span id="grand-total">0.00</span>
                </div>
            </div>
        </div>

        <div class="app-controls">
            <div class="template-selector">
                <label>Online Free Invoice Generator Templates:</label>
                <div class="template-options">
                    <div class="template-option">
                        <input type="radio" id="template-modern1" name="template" value="modern1" checked>
                        <label for="template-modern1">
                            <svg width="100" height="140" viewBox="0 0 100 140" aria-label="Modern Invoice Template Preview">
                                <rect x="5" y="5" width="90" height="130" rx="2" fill="#f9fafb" stroke="#e5e7eb" stroke-width="1"/>
                                <rect x="10" y="15" width="80" height="15" rx="1" fill="#4f46e5"/>
                                <rect x="10" y="40" width="35" height="8" rx="1" fill="#e5e7eb"/>
                                <rect x="50" y="40" width="35" height="8" rx="1" fill="#e5e7eb"/>
                                <rect x="10" y="55" width="80" height="40" rx="1" fill="#f3f4f6" stroke="#e5e7eb" stroke-width="0.5"/>
                                <rect x="10" y="105" width="50" height="20" rx="1" fill="#f3f4f6" stroke="#e5e7eb" stroke-width="0.5"/>
                                <rect x="65" y="105" width="25" height="20" rx="1" fill="#4f46e5"/>
                            </svg>
                            <span>Modern Invoice Template</span>
                        </label>
                    </div>
                    <div class="template-option">
                        <input type="radio" id="template-classic" name="template" value="classic">
                        <label for="template-classic">
                            <svg width="100" height="140" viewBox="0 0 100 140" aria-label="Classic Business Invoice Preview">
                                <rect x="5" y="5" width="90" height="130" rx="0" fill="white" stroke="#1f2937" stroke-width="2"/>
                                <rect x="10" y="15" width="80" height="15" rx="0" fill="#1f2937"/>
                                <rect x="10" y="40" width="35" height="8" rx="0" fill="#e5e7eb"/>
                                <rect x="50" y="40" width="35" height="8" rx="0" fill="#e5e7eb"/>
                                <rect x="10" y="55" width="80" height="40" rx="0" fill="#f9fafb" stroke="#1f2937" stroke-width="1"/>
                                <rect x="10" y="105" width="50" height="20" rx="0" fill="#f9fafb" stroke="#1f2937" stroke-width="1"/>
                                <rect x="65" y="105" width="25" height="20" rx="0" fill="#1f2937"/>
                            </svg>
                            <span>Classic Business Invoice</span>
                        </label>
                    </div>
                    <div class="template-option">
                        <input type="radio" id="template-business" name="template" value="business">
                        <label for="template-business">
                            <svg width="100" height="140" viewBox="0 0 100 140" aria-label="Professional Business Invoice Preview">
                                <rect x="5" y="5" width="90" height="130" rx="3" fill="white" stroke="#2563eb" stroke-width="1"/>
                                <rect x="10" y="15" width="80" height="15" rx="2" fill="#2563eb"/>
                                <rect x="10" y="40" width="35" height="8" rx="1" fill="#dbeafe"/>
                                <rect x="50" y="40" width="35" height="8" rx="1" fill="#dbeafe"/>
                                <rect x="10" y="55" width="80" height="40" rx="2" fill="#eff6ff" stroke="#93c5fd" stroke-width="0.5"/>
                                <rect x="10" y="105" width="50" height="20" rx="2" fill="#eff6ff" stroke="#93c5fd" stroke-width="0.5"/>
                                <rect x="65" y="105" width="25" height="20" rx="2" fill="#2563eb"/>
                            </svg>
                            <span>Professional Business Invoice</span>
                        </label>
                    </div>
                </div>
            </div>
            <button id="download-btn" class="btn btn-success">Download PDF Invoice</button>
        </div>
    </div>
</main>

    <script>
        // Invoice data model
        const invoiceData = {
            invoiceNumber: "INV-0001",
            date: new Date().toISOString().split('T')[0],
            currency: "USD",
            sender: {
                name: "",
                address: "",
                email: ""
            },
            recipient: {
                name: "",
                address: "",
                email: ""
            },
            lineItems: [
                {
                    description: "",
                    quantity: 0,
                    rate: 0.0,
                    tax: 0.0,
                    amount: 0.0,
                    taxAmount: 0.0
                }
            ],
            subtotal: 0.0,
            totalTax: 0.0,
            discount: 0.0,
            grandTotal: 0.0
        };

        // Validation errors
        const validationErrors = {
            sender: {
                name: "",
                address: "",
                email: ""
            },
            recipient: {
                name: "",
                address: "",
                email: ""
            },
            invoiceNumber: "",
            date: ""
        };

        // Currency symbols
        const currencySymbols = {
            "USD": "$ ",
            "EUR": "€ ",
            "GBP": "£ ",
            "CAD": "CAD ",
            "AUD": "AUD ",
            "JPY": "JPY ",
            "CNY": "CNY ",
            "INR": "INR ",
            "BRL": "BRL ",
            "MXN": "MXN ",
            "SGD": "SGD ",
            "NZD": "NZD ",
            "CHF": "CHF ",
            "HKD": "HKD ",
            "SEK": "SEK ",
            "NOK": "NOK ",
            "DKK": "DKK ",
            "ZAR": "ZAR ",
            "RUB": "RUB ",
            "KRW": "KRW ",
            "TRY": "TRY ",
            "AED": "AED ",
            "SAR": "SAR ",
            "ILS": "ILS ",
            "ARS": "ARS ",
            "CLP": "CLP ",
            "COP": "COP ",
            "PEN": "PEN ",
            "UYU": "UYU ",
            "EGP": "EGP "
        };

        // Template configurations
        const templates = [
            {
                templateId: "modern1",
                name: "Modern Minimal",
                primaryColor: "#4f46e5",
                cssOverrides: "",
                layoutConfig: { showTaxColumn: true, discountPosition: "belowTotal" }
            },
            {
                templateId: "classic",
                name: "Classic Business",
                primaryColor: "#1f2937",
                cssOverrides: "",
                layoutConfig: { showTaxColumn: true, discountPosition: "belowTotal" }
            },
            {
                templateId: "business",
                name: "Professional",
                primaryColor: "#2563eb",
                cssOverrides: "",
                layoutConfig: { showTaxColumn: true, discountPosition: "belowTotal" }
            }
        ];

        // DOM Elements
        const templateSelect = document.getElementById('template-select');
        const currencySelect = document.getElementById('currency-select');
        const invoiceContainer = document.getElementById('invoice-container');
        const addItemBtn = document.getElementById('add-item-btn');
        const downloadBtn = document.getElementById('download-btn');
        const lineItemsTable = document.getElementById('line-items').getElementsByTagName('tbody')[0];

        // Initialize the app
        function init() {
            // Set today's date as default
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('invoice-date').value = today;
            invoiceData.date = today;
            
            // Set default template
            invoiceData.template = 'modern1';
            
            // Set default currency based on user's browser language
            const userLanguage = navigator.language || navigator.userLanguage || 'en-US';
            const languageToCurrencyMap = {
                'en-US': 'USD',
                'en-GB': 'GBP',
                'en-AU': 'AUD',
                'en-CA': 'CAD',
                'en-IN': 'INR',
                'en-SG': 'SGD',
                'en-NZ': 'NZD',
                'en-ZA': 'ZAR',
                'de': 'EUR',
                'de-DE': 'EUR',
                'de-CH': 'CHF',
                'fr': 'EUR',
                'fr-FR': 'EUR',
                'fr-CH': 'CHF',
                'es': 'EUR',
                'es-ES': 'EUR',
                'es-MX': 'MXN',
                'es-AR': 'ARS',
                'es-CL': 'CLP',
                'es-CO': 'COP',
                'es-PE': 'PEN',
                'es-UY': 'UYU',
                'it': 'EUR',
                'it-IT': 'EUR',
                'it-CH': 'CHF',
                'pt': 'EUR',
                'pt-PT': 'EUR',
                'pt-BR': 'BRL',
                'nl': 'EUR',
                'nl-NL': 'EUR',
                'ja': 'JPY',
                'ja-JP': 'JPY',
                'zh': 'CNY',
                'zh-CN': 'CNY',
                'zh-HK': 'HKD',
                'hi': 'INR',
                'hi-IN': 'INR',
                'sv': 'SEK',
                'sv-SE': 'SEK',
                'no': 'NOK',
                'nb': 'NOK',
                'nn': 'NOK',
                'da': 'DKK',
                'da-DK': 'DKK',
                'ru': 'RUB',
                'ru-RU': 'RUB',
                'ko': 'KRW',
                'ko-KR': 'KRW',
                'tr': 'TRY',
                'tr-TR': 'TRY',
                'ar': 'AED',
                'ar-AE': 'AED',
                'ar-SA': 'SAR',
                'he': 'ILS',
                'he-IL': 'ILS',
                'ar-EG': 'EGP'
            };
            
            // Try to get currency from language map, fallback to USD
            const defaultCurrency = languageToCurrencyMap[userLanguage] || languageToCurrencyMap[userLanguage.split('-')[0]] || 'USD';
            document.getElementById('currency-select').value = defaultCurrency;
            invoiceData.currency = defaultCurrency;
            
            // Add event listeners
            document.getElementById('sender-name').addEventListener('input', (e) => {
                invoiceData.sender.name = e.target.value;
                validateField('sender', 'name', e.target.value);
            });
            
            document.getElementById('sender-address').addEventListener('input', (e) => {
                invoiceData.sender.address = e.target.value;
                validateField('sender', 'address', e.target.value);
            });
            
            document.getElementById('sender-email').addEventListener('input', (e) => {
                invoiceData.sender.email = e.target.value;
                validateField('sender', 'email', e.target.value);
            });
            
            document.getElementById('recipient-name').addEventListener('input', (e) => {
                invoiceData.recipient.name = e.target.value;
                validateField('recipient', 'name', e.target.value);
            });
            
            document.getElementById('recipient-address').addEventListener('input', (e) => {
                invoiceData.recipient.address = e.target.value;
                validateField('recipient', 'address', e.target.value);
            });
            
            document.getElementById('recipient-email').addEventListener('input', (e) => {
                invoiceData.recipient.email = e.target.value;
                validateField('recipient', 'email', e.target.value);
            });
            
            document.getElementById('invoice-number').addEventListener('input', (e) => {
                invoiceData.invoiceNumber = e.target.value;
                validateField('invoiceNumber', null, e.target.value);
            });
            
            document.getElementById('invoice-date').addEventListener('input', (e) => {
                invoiceData.date = e.target.value;
                validateField('date', null, e.target.value);
            });
            
            document.getElementById('currency-select').addEventListener('change', (e) => {
                invoiceData.currency = e.target.value;
                calculateTotals();
            });
            
            document.getElementById('discount').addEventListener('input', (e) => {
                invoiceData.discount = parseFloat(e.target.value) || 0;
                calculateTotals();
            });
            
            document.getElementById('add-item-btn').addEventListener('click', addItem);
            document.getElementById('download-btn').addEventListener('click', downloadPDF);
            
            // Add template selection event listeners
            document.querySelectorAll('input[name="template"]').forEach(radio => {
                radio.addEventListener('change', (e) => {
                    if (e.target.checked) {
                        invoiceData.template = e.target.value;
                        updateTemplate();
                    }
                });
            });
            
            // Add event listener to the first row
            const firstRow = lineItemsTable.rows[0];
            const firstDescriptionInput = firstRow.querySelector('.item-description');
            const firstQuantityInput = firstRow.querySelector('.item-quantity');
            const firstRateInput = firstRow.querySelector('.item-rate');
            const firstTaxInput = firstRow.querySelector('.item-tax');
            
            firstDescriptionInput.addEventListener('input', (e) => {
                invoiceData.lineItems[0].description = e.target.value;
            });
            
            firstQuantityInput.addEventListener('input', (e) => {
                const value = parseFloat(e.target.value) || 0;
                invoiceData.lineItems[0].quantity = value;
                if (value < 0) {
                    e.target.classList.add('invalid');
                } else {
                    e.target.classList.remove('invalid');
                }
                calculateLineItemAmount(0);
            });
            
            firstRateInput.addEventListener('input', (e) => {
                const value = parseFloat(e.target.value) || 0;
                invoiceData.lineItems[0].rate = value;
                if (value < 0) {
                    e.target.classList.add('invalid');
                } else {
                    e.target.classList.remove('invalid');
                }
                calculateLineItemAmount(0);
            });
            
            firstTaxInput.addEventListener('input', (e) => {
                const value = parseFloat(e.target.value) || 0;
                invoiceData.lineItems[0].tax = Math.max(0, Math.min(100, value)); // Clamp between 0 and 100
                if (value < 0 || value > 100) {
                    e.target.classList.add('invalid');
                } else {
                    e.target.classList.remove('invalid');
                }
                calculateLineItemAmount(0);
            });
            
            // Initialize with one line item
            calculateLineItemAmount(0);
            
            // Apply initial template
            updateTemplate();
        }

        // Set default currency based on browser locale
        function setDefaultCurrency() {
            const locale = navigator.language || 'en-US';
            let currency = 'USD';
            
            if (locale.startsWith('en-GB')) {
                currency = 'GBP';
            } else if (locale.startsWith('en-AU')) {
                currency = 'AUD';
            } else if (locale.startsWith('en-CA')) {
                currency = 'CAD';
            } else if (locale.startsWith('de') || locale.startsWith('fr') || locale.startsWith('es') || locale.startsWith('it')) {
                currency = 'EUR';
            }
            
            invoiceData.currency = currency;
            currencySelect.value = currency;
        }

        // Set up event listeners
        function setupEventListeners() {
            // Template selection
            templateSelect.addEventListener('change', (e) => {
                applyTemplate(e.target.value);
            });

            // Currency selection
            currencySelect.addEventListener('change', (e) => {
                invoiceData.currency = e.target.value;
                updateCurrencyDisplay();
            });

            // Add item button
            addItemBtn.addEventListener('click', addItem);

            // Download button
            downloadBtn.addEventListener('click', downloadPDF);

            // Invoice metadata fields with validation
            document.getElementById('sender-name').addEventListener('input', (e) => {
                invoiceData.sender.name = e.target.value;
                validateField('sender', 'name', e.target.value);
            });

            document.getElementById('sender-address').addEventListener('input', (e) => {
                invoiceData.sender.address = e.target.value;
                validateField('sender', 'address', e.target.value);
            });

            document.getElementById('sender-email').addEventListener('input', (e) => {
                invoiceData.sender.email = e.target.value;
                validateField('sender', 'email', e.target.value);
            });

            document.getElementById('recipient-name').addEventListener('input', (e) => {
                invoiceData.recipient.name = e.target.value;
                validateField('recipient', 'name', e.target.value);
            });

            document.getElementById('recipient-address').addEventListener('input', (e) => {
                invoiceData.recipient.address = e.target.value;
                validateField('recipient', 'address', e.target.value);
            });

            document.getElementById('recipient-email').addEventListener('input', (e) => {
                invoiceData.recipient.email = e.target.value;
                validateField('recipient', 'email', e.target.value);
            });

            document.getElementById('invoice-number').addEventListener('input', (e) => {
                invoiceData.invoiceNumber = e.target.value;
                validateField('invoiceNumber', null, e.target.value);
            });

            document.getElementById('invoice-date').addEventListener('input', (e) => {
                invoiceData.date = e.target.value;
                validateField('date', null, e.target.value);
            });

            document.getElementById('discount').addEventListener('input', (e) => {
                invoiceData.discount = parseFloat(e.target.value) || 0;
                calculateTotals();
            });

            // Add event listeners for the first row
            const firstRow = lineItemsTable.rows[0];
            const firstDescriptionInput = firstRow.querySelector('.item-description');
            const firstQuantityInput = firstRow.querySelector('.item-quantity');
            const firstRateInput = firstRow.querySelector('.item-rate');
            const firstTaxInput = firstRow.querySelector('.item-tax');
            
            firstDescriptionInput.addEventListener('input', (e) => {
                invoiceData.lineItems[0].description = e.target.value;
            });
            
            firstQuantityInput.addEventListener('input', (e) => {
                const value = parseFloat(e.target.value) || 0;
                invoiceData.lineItems[0].quantity = value;
                if (value < 0) {
                    e.target.classList.add('invalid');
                } else {
                    e.target.classList.remove('invalid');
                }
                calculateLineItemAmount(0);
            });
            
            firstRateInput.addEventListener('input', (e) => {
                const value = parseFloat(e.target.value) || 0;
                invoiceData.lineItems[0].rate = value;
                if (value < 0) {
                    e.target.classList.add('invalid');
                } else {
                    e.target.classList.remove('invalid');
                }
                calculateLineItemAmount(0);
            });
            
            firstTaxInput.addEventListener('input', (e) => {
                const value = parseFloat(e.target.value) || 0;
                invoiceData.lineItems[0].tax = Math.max(0, Math.min(100, value)); // Clamp between 0 and 100
                if (value < 0 || value > 100) {
                    e.target.classList.add('invalid');
                } else {
                    e.target.classList.remove('invalid');
                }
                calculateLineItemAmount(0);
            });
        }

        // Validate a field
        function validateField(section, field, value) {
            let isValid = true;
            let errorMessage = "";
            
            if (section === 'sender' || section === 'recipient') {
                if (field === 'name' && !value.trim()) {
                    isValid = false;
                    errorMessage = "Name is required.";
                } else if (field === 'email' && value && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value)) {
                    isValid = false;
                    errorMessage = "Please enter a valid email address.";
                }
                validationErrors[section][field] = errorMessage;
                updateErrorDisplay(`${section}-${field}-error`, errorMessage, `${section}-${field}`);
            } else if (section === 'invoiceNumber') {
                if (!value.trim()) {
                    isValid = false;
                    errorMessage = "Invoice number is required.";
                }
                validationErrors.invoiceNumber = errorMessage;
                updateErrorDisplay('invoice-number-error', errorMessage, 'invoice-number');
            } else if (section === 'date') {
                if (!value) {
                    isValid = false;
                    errorMessage = "Date is required.";
                }
                validationErrors.date = errorMessage;
                updateErrorDisplay('invoice-date-error', errorMessage, 'invoice-date');
            }
            
            return isValid;
        }

        // Update error display
        function updateErrorDisplay(errorElementId, errorMessage, inputElementId) {
            const errorElement = document.getElementById(errorElementId);
            const inputElement = document.getElementById(inputElementId);
            
            if (errorMessage) {
                errorElement.textContent = errorMessage;
                inputElement.classList.add('invalid');
            } else {
                errorElement.textContent = "";
                inputElement.classList.remove('invalid');
            }
        }

        // Update template
        function updateTemplate() {
            // Remove all template classes
            invoiceContainer.classList.remove('template-modern1', 'template-classic', 'template-business');
            
            // Add the selected template class
            invoiceContainer.classList.add(`template-${invoiceData.template}`);
            
            // Update table header styles
            const tableHeaders = document.querySelectorAll('.line-items th');
            tableHeaders.forEach(th => {
                // Remove all template classes
                th.classList.remove('template-modern1', 'template-classic', 'template-business');
                // Add the selected template class
                th.classList.add(`template-${invoiceData.template}`);
            });
            
            // Update add item button styles
            const addItemBtn = document.getElementById('add-item-btn');
            // Remove all template classes
            addItemBtn.classList.remove('template-modern1', 'template-classic', 'template-business');
            // Add the selected template class
            addItemBtn.classList.add(`template-${invoiceData.template}`);
            
            // Update line items table styles
            const lineItemsTable = document.getElementById('line-items');
            // Remove all template classes
            lineItemsTable.classList.remove('template-modern1', 'template-classic', 'template-business');
            // Add the selected template class
            lineItemsTable.classList.add(`template-${invoiceData.template}`);
        }

        // Add a new line item
        function addItem() {
            const newRow = lineItemsTable.insertRow();
            
            const index = invoiceData.lineItems.length;
            
            newRow.innerHTML = `
                <td data-label="Description"><textarea class="item-description" placeholder="Item description"></textarea></td>
                <td data-label="Quantity"><input type="number" class="item-quantity" placeholder="0" min="0" step="1"></td>
                <td data-label="Rate"><input type="number" class="item-rate" placeholder="0.00" min="0" step="0.01"></td>
                <td data-label="Tax (%)" class="tax-cell">
                    <input type="number" class="item-tax" placeholder="0" min="0" max="100" step="0.1">
                    <div class="tax-amount" id="tax-amount-${index}"></div>
                </td>
                <td data-label="Amount" class="item-amount">0.00</td>
            `;
            
            // Add event listeners to the new row
            const descriptionInput = newRow.querySelector('.item-description');
            const quantityInput = newRow.querySelector('.item-quantity');
            const rateInput = newRow.querySelector('.item-rate');
            const taxInput = newRow.querySelector('.item-tax');
            
            // Add to invoice data
            invoiceData.lineItems.push({
                description: "",
                quantity: 0,
                rate: 0.0,
                tax: 0.0,
                amount: 0.0,
                taxAmount: 0.0
            });
            
            descriptionInput.addEventListener('input', (e) => {
                invoiceData.lineItems[index].description = e.target.value;
            });
            
            quantityInput.addEventListener('input', (e) => {
                const value = parseFloat(e.target.value) || 0;
                invoiceData.lineItems[index].quantity = value;
                if (value < 0) {
                    e.target.classList.add('invalid');
                } else {
                    e.target.classList.remove('invalid');
                }
                calculateLineItemAmount(index);
            });
            
            rateInput.addEventListener('input', (e) => {
                const value = parseFloat(e.target.value) || 0;
                invoiceData.lineItems[index].rate = value;
                if (value < 0) {
                    e.target.classList.add('invalid');
                } else {
                    e.target.classList.remove('invalid');
                }
                calculateLineItemAmount(index);
            });
            
            taxInput.addEventListener('input', (e) => {
                const value = parseFloat(e.target.value) || 0;
                invoiceData.lineItems[index].tax = Math.max(0, Math.min(100, value)); // Clamp between 0 and 100
                if (value < 0 || value > 100) {
                    e.target.classList.add('invalid');
                } else {
                    e.target.classList.remove('invalid');
                }
                calculateLineItemAmount(index);
            });
        }

        // Calculate line item amount
        function calculateLineItemAmount(index) {
            const item = invoiceData.lineItems[index];
            const amount = item.quantity * item.rate * (1 + item.tax / 100);
            const taxAmount = item.quantity * item.rate * item.tax / 100;
            
            item.amount = parseFloat(amount.toFixed(2));
            item.taxAmount = parseFloat(taxAmount.toFixed(2));
            
            // Update UI
            const amountCell = lineItemsTable.rows[index].cells[4];
            amountCell.textContent = item.amount.toFixed(2);
            
            // Update tax amount display
            const taxAmountElement = document.getElementById(`tax-amount-${index}`);
            if (taxAmountElement) {
                taxAmountElement.textContent = `(${item.taxAmount.toFixed(2)})`;
            }
            
            calculateTotals();
        }

        // Calculate invoice totals
        function calculateTotals() {
            // Calculate subtotal
            invoiceData.subtotal = invoiceData.lineItems.reduce((sum, item) => sum + (item.quantity * item.rate), 0);
            
            // Calculate total tax
            invoiceData.totalTax = invoiceData.lineItems.reduce((sum, item) => {
                return sum + (item.quantity * item.rate * item.tax / 100);
            }, 0);
            
            // Calculate grand total
            invoiceData.grandTotal = invoiceData.subtotal + invoiceData.totalTax - invoiceData.discount;
            
            // Update UI
            updateCurrencyDisplay();
        }

        // Helper function to get currency symbol or code
        function getCurrencyDisplay(currencyCode) {
            return currencySymbols[currencyCode] || `${currencyCode} `;
        }

        // Update currency display
        function updateCurrencyDisplay() {
            const currencyDisplay = getCurrencyDisplay(invoiceData.currency);
            
            document.getElementById('subtotal').textContent = `${currencyDisplay}${invoiceData.subtotal.toFixed(2)}`;
            document.getElementById('total-tax').textContent = `${currencyDisplay}${invoiceData.totalTax.toFixed(2)}`;
            document.getElementById('grand-total').textContent = `${currencyDisplay}${invoiceData.grandTotal.toFixed(2)}`;
            
            // Update line item amounts
            for (let i = 0; i < invoiceData.lineItems.length; i++) {
                const amountCell = lineItemsTable.rows[i].cells[4];
                if (amountCell) {
                    amountCell.textContent = `${currencyDisplay}${invoiceData.lineItems[i].amount.toFixed(2)}`;
                }
            }
        }

        // Download PDF
        function downloadPDF() {
            // Validate all required fields before generating PDF
            const isSenderValid = validateField('sender', 'name', invoiceData.sender.name);
            const isRecipientValid = validateField('recipient', 'name', invoiceData.recipient.name);
            const isInvoiceNumberValid = validateField('invoiceNumber', null, invoiceData.invoiceNumber);
            const isDateValid = validateField('date', null, invoiceData.date);
            
            if (!isSenderValid || !isRecipientValid || !isInvoiceNumberValid || !isDateValid) {
                alert("Please fix validation errors before downloading the PDF.");
                return;
            }
            
            // Use jsPDF to generate PDF
            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                // Get current template
                const currentTemplate = invoiceData.template;
                
                // Get template config
                const template = templates.find(t => t.templateId === currentTemplate);
                const primaryColor = template ? template.primaryColor : "#4f46e5";
                
                // Convert hex color to RGB
                const hexToRgb = (hex) => {
                    const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
                    return result ? [
                        parseInt(result[1], 16),
                        parseInt(result[2], 16),
                        parseInt(result[3], 16)
                    ] : [79, 70, 229]; // Default to indigo
                };
                
                const headerColor = hexToRgb(primaryColor);
                
                // Set font and size
                doc.setFont("helvetica");
                doc.setFontSize(12);
                
                // Add invoice header with template-specific styling
                doc.setFontSize(22);
                doc.setTextColor(...headerColor);
                doc.text("INVOICE", 20, 20);
                
                // Reset text color
                doc.setTextColor(0, 0, 0);
                
                // Add invoice info
                doc.setFontSize(12);
                doc.text(`Invoice Number: ${invoiceData.invoiceNumber}`, 20, 35);
                
                // Add date right aligned with invoice number
                const dateText = `Date: ${invoiceData.date}`;
                const dateWidth = doc.getTextWidth(dateText);
                doc.text(dateText, 190 - dateWidth, 35);
                
                // Add sender info
                doc.setFontSize(14);
                doc.setTextColor(...headerColor);
                doc.text("From:", 20, 70);
                doc.setTextColor(0, 0, 0);
                doc.setFontSize(12);
                doc.text(invoiceData.sender.name, 20, 80);
                // Split address into multiple lines if needed
                const senderAddressLines = doc.splitTextToSize(invoiceData.sender.address, 80);
                doc.text(senderAddressLines, 20, 90);
                const senderAddressHeight = senderAddressLines.length * 5;
                doc.text(invoiceData.sender.email, 20, 90 + senderAddressHeight);
                
                // Add recipient info
                doc.setFontSize(14);
                doc.setTextColor(...headerColor);
                doc.text("To:", 120, 70);
                doc.setTextColor(0, 0, 0);
                doc.setFontSize(12);
                doc.text(invoiceData.recipient.name, 120, 80);
                // Split address into multiple lines if needed
                const recipientAddressLines = doc.splitTextToSize(invoiceData.recipient.address, 80);
                doc.text(recipientAddressLines, 120, 90);
                const recipientAddressHeight = recipientAddressLines.length * 5;
                doc.text(invoiceData.recipient.email, 120, 90 + recipientAddressHeight);
                
                // Calculate the starting Y position for the table
                const tableStartY = Math.max(110, 100 + Math.max(senderAddressHeight, recipientAddressHeight) + 10);
                
                // Add some extra spacing before the table
                const adjustedTableStartY = tableStartY + 10;
                
                // Add line items table with template-specific styling
                const headers = [["Description", "Quantity", "Rate", "Tax %", "Amount"]];
                // Use currency symbol if available, otherwise use currency code
                const currencyDisplay = getCurrencyDisplay(invoiceData.currency);
                const rows = invoiceData.lineItems.map(item => [
                    item.description,
                    item.quantity,
                    `${currencyDisplay}${item.rate.toFixed(2)}`,
                    item.tax,
                    `${currencyDisplay}${item.amount.toFixed(2)}`
                ]);
                
                doc.autoTable({
                    head: headers,
                    body: rows,
                    startY: adjustedTableStartY,
                    theme: 'grid',
                    headStyles: {
                        fillColor: headerColor,
                        textColor: [255, 255, 255]
                    },
                    styles: {
                        cellPadding: 3,
                        fontSize: 10
                    }
                });
                
                // Add totals with template-specific styling
                const finalY = doc.lastAutoTable.finalY || adjustedTableStartY + 40;
                doc.setTextColor(0, 0, 0);
                doc.setFontSize(12);
                
                // Left align labels, right align numbers
                const labelX = 140;
                const valueX = 190;
                const lineHeight = 10;
                // Use currency symbol if available, otherwise use currency code
                // currencyDisplay is already declared above in the line items section
                
                doc.text('Subtotal:', labelX, finalY + lineHeight);
                const subtotalText = `${currencyDisplay}${invoiceData.subtotal.toFixed(2)}`;
                const subtotalWidth = doc.getTextWidth(subtotalText);
                doc.text(subtotalText, valueX - subtotalWidth, finalY + lineHeight);
                
                doc.text('Total Tax:', labelX, finalY + (lineHeight * 2));
                const taxText = `${currencyDisplay}${invoiceData.totalTax.toFixed(2)}`;
                const taxWidth = doc.getTextWidth(taxText);
                doc.text(taxText, valueX - taxWidth, finalY + (lineHeight * 2));
                
                doc.text('Discount:', labelX, finalY + (lineHeight * 3));
                const discountText = `-${currencyDisplay}${invoiceData.discount.toFixed(2)}`;
                const discountWidth = doc.getTextWidth(discountText);
                doc.text(discountText, valueX - discountWidth, finalY + (lineHeight * 3));
                
                doc.setFontSize(14);
                doc.setTextColor(...headerColor);
                doc.text('Grand Total:', labelX, finalY + (lineHeight * 4));
                const grandTotalText = `${currencyDisplay}${invoiceData.grandTotal.toFixed(2)}`;
                const grandTotalWidth = doc.getTextWidth(grandTotalText);
                doc.text(grandTotalText, valueX - grandTotalWidth, finalY + (lineHeight * 4));
                
                // Add some extra space after totals
                const contentEndY = finalY + (lineHeight * 5);
                
                // Save the PDF
                doc.save(`invoice-${invoiceData.invoiceNumber}.pdf`);
            } catch (error) {
                console.error("Error generating PDF:", error);
                alert("Error generating PDF. Please try again.");
            }
        }

        // Initialize the app when the DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</main>
</body>
</html>